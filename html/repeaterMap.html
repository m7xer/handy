<!DOCTYPE html>
<head>
<title>printable repeater map</title>
<script src="https://unpkg.com/lightning-maps/lib/LightningMaps.min.js"></script>
</head>
<body>
<canvas id="mapcanvas" width="1080" height="720"></canvas>
<div id="stations"></div>
<script>
// an alternative to https://ukrepeater.net/70cm.htm and https://ukrepeater.net/2m.htm
var map = new LightningMaps.Map(mapcanvas, {
  source: function (x, y, z) {
    return `https://b.tile.openstreetmap.org/${z}/${x}/${y}.png`;
  },
  zoom: 8,
  center: [52.458333333333336, -1.9166666666666667]
});

var TW = 64
var TH = 32
var MIDX = TW / 2
var MIDY = TH / 2

// two = blue
var TWO_METER_COL = 'blue'
var SEVNY_CEMS = 'darkred'

function addStation(obj, channelNum) {
  // create offscreen canvas to render our station marker
  let textcanvas = document.createElement('canvas')
  textcanvas.width = TW
  textcanvas.height = TH
  let tctx = textcanvas.getContext("2d")
  tctx.imageSmoothingEnabled = false
  tctx.textAlign = "center";
  tctx.font = "16px Arial"

  // slight opacity to give idea of the marker bounds
  tctx.fillStyle = 'rgba(255,255,255,0.2)'// 'transparent' //'#ccc'
  tctx.fillRect(0, 0, TW, TH)

  // X marks the spot
  tctx.strokeStyle = 'black'//'#333'
  let crossSize = 5
  tctx.beginPath()
  tctx.moveTo(MIDX - crossSize, MIDY - crossSize)
  tctx.lineTo(MIDX + crossSize, MIDY + crossSize)
  tctx.stroke()

  tctx.beginPath()
  tctx.moveTo(MIDX + crossSize, MIDY - crossSize)
  tctx.lineTo(MIDX - crossSize, MIDY + crossSize)
  tctx.stroke()

  let isTwoMeter = obj.band === '2M'
  let stationName = `${obj.repeater.substring(2)}(${channelNum})`

  // Change colour based on band
  tctx.fillStyle = tctx.strokeStyle = isTwoMeter ? TWO_METER_COL : SEVNY_CEMS

  // Do 2M text above the line, 70cm will be below
  // (this helps when two repeaters are located in the same station!)
  tctx.fillText(stationName, MIDX, TH-2 - (isTwoMeter * MIDY ))
  tctx.beginPath()
  tctx.moveTo(0, MIDY)
  tctx.lineTo(TW, MIDY)
  tctx.stroke()

  let lat = Number(obj.lat)
  let lon = Number(obj.lon)
  console.log(`adding station ${lat}, ${lon} ${obj.repeater}`)
  // debug marker with default icon
  // map.addMarker(new LightningMaps.Marker([lat, 	lon]))
  map.addMarker(new LightningMaps.Marker([lat, 	lon], { type: 'image', image: textcanvas }))
}

var repeaters = [{"repeater":"GB3CB","band":"70CM","channel":"RB14","TX":"433.3500","RX":"434.9500","mode":"AV","QTHR":"IO92BL","where":"BIRMINGHAM","region":"MIDL","code":"67","keeper":"G8NDT","lat":"52.46","lon":"-1.89","":"","distance":1816.2539887041903},{"repeater":"GB3BM","band":"2M","channel":"RV57","TX":"145.7125","RX":"145.1125","mode":"AV","QTHR":"IO82XL","where":"DUDLEY","region":"MIDL","code":"67.0","keeper":"G8PYT","lat":"52.48","lon":"-2.05","":"","distance":9347.624891989148},{"repeater":"GB3RR","band":"70CM","channel":"RU68","TX":"430.8500","RX":"438.4500","mode":"AV","QTHR":"IO82XL","where":"DUDLEY","region":"MIDL","code":"67.0","keeper":"G8PYT","lat":"52.48","lon":"-2.05","":"","distance":9347.624891989148},{"repeater":"GB3GB","band":"70CM","channel":"RB12","TX":"433.3000","RX":"434.9000","mode":"AV","QTHR":"IO92BM","where":"SUTTON COLDFIELD","region":"MIDL","code":"67","keeper":"G8NDT","lat":"52.53","lon":"-1.84","":"","distance":9510.212673081944},{"repeater":"GB3KC","band":"70CM","channel":"RU72","TX":"430.9000","RX":"438.5000","mode":"AV","QTHR":"IO82WK","where":"STOURBRIDGE","region":"MIDL","code":"67","keeper":"G0EWH","lat":"52.44","lon":"-2.12","":"","distance":13929.754332832303},{"repeater":"GB3IC","band":"70CM","channel":"RB05","TX":"433.1250","RX":"434.7250","mode":"AV","QTHR":"IO82WO","where":"WOLVERHAMPTON","region":"MIDL","code":"67","keeper":"M0VRR","lat":"52.60","lon":"-2.10","":"","distance":20048.67412488803},{"repeater":"GB3WN","band":"70CM","channel":"UR63","TX":"438.3875","RX":"430.7875","mode":"AV","QTHR":"IO82XP","where":"WOLVERHAMPTON","region":"MIDL","code":"67.0","keeper":"G8NDT","lat":"52.63","lon":"-2.08","":"","distance":22053.647720940346},{"repeater":"GB3KA","band":"70CM","channel":"RU71","TX":"430.8875","RX":"438.4875","mode":"AV","QTHR":"IO82UJ","where":"KIDDERMINSTER","region":"WM","code":"118.8","keeper":"G0EWH","lat":"52.40","lon":"-2.25","":"","distance":23512.437343220226},{"repeater":"GB3TA","band":"2M","channel":"RV59","TX":"145.7375","RX":"145.1375","mode":"AV","QTHR":"IO92DP","where":"TAMWORTH","region":"MIDL","code":"67","keeper":"M0TSD","lat":"52.63","lon":"-1.70","":"","distance":24063.252444695387},{"repeater":"GB3KR","band":"70CM","channel":"RU65","TX":"430.8125","RX":"438.4125","mode":"AV","QTHR":"IO82UI","where":"STOURPORT ON SEVERN","region":"WM","code":"118.8","keeper":"G7SAI","lat":"52.34","lon":"-2.26","":"","distance":26753.290958686724},{"repeater":"GB3CV","band":"70CM","channel":"RU65","TX":"430.8125","RX":"438.4125","mode":"AV","QTHR":"IO92GK","where":"COVENTRY","region":"MIDL","code":"67","keeper":"G4USP","lat":"52.42","lon":"-1.48","":"","distance":29904.653121445084},{"repeater":"GB3MW","band":"70CM","channel":"RB10","TX":"433.2500","RX":"434.8500","mode":"AV","QTHR":"IO92FH","where":"LEAMINGTON SPA","region":"MIDL","code":"67","keeper":"G6FEO","lat":"52.30","lon":"-1.51","":"","distance":32739.97699556841},{"repeater":"GB3WK","band":"2M","channel":"RV62","TX":"145.7750","RX":"145.1750","mode":"AV","QTHR":"IO92FH","where":"LEAMINGTON SPA","region":"MIDL","code":"67","keeper":"G6FEO","lat":"52.30","lon":"-1.51","":"","distance":32739.97699556841},{"repeater":"GB3WU","band":"70CM","channel":"RU66","TX":"430.8250","RX":"438.4250","mode":"AV","QTHR":"IO82VE","where":"WORCESTER","region":"WM","code":"118.8","keeper":"G8TIC","lat":"52.20","lon":"-2.21","":"","distance":34963.864346714756},{"repeater":"GB3SV","band":"2M","channel":"RV49","TX":"145.6125","RX":"145.0125","mode":"AV","QTHR":"IO82WS","where":"STAFFORD","region":"MIDL","code":"94.8","keeper":"G7PFT","lat":"52.77","lon":"-2.16","":"","distance":38352.56841727131},{"repeater":"GB3HT","band":"70CM","channel":"RB11","TX":"433.2750","RX":"434.8750","mode":"AV","QTHR":"IO92HN","where":"HINCKLEY","region":"MIDL","code":"77.0","keeper":"M0RVD","lat":"52.55","lon":"-1.37","":"","distance":38379.169944748886},{"repeater":"GB3SC","band":"70CM","channel":"RU69","TX":"430.8625","RX":"438.4625","mode":"AV","QTHR":"IO92ES","where":"BURTON-UPON-TRENT","region":"MIDL","code":"67.0","keeper":"G8EKG","lat":"52.78","lon":"-1.62","":"","distance":40992.82697872697},{"repeater":"GB3HN","band":"70CM","channel":"RB01","TX":"433.0250","RX":"434.6250","mode":"AV","QTHR":"IO82QJ","where":"LUDLOW","region":"WM","code":"103.5","keeper":"M0HOY","lat":"52.39","lon":"-2.58","":"","distance":45616.33251053504},{"repeater":"GB3ME","band":"70CM","channel":"RB06","TX":"433.1500","RX":"434.7500","mode":"AV","QTHR":"IO92JJ","where":"RUGBY","region":"MIDL","code":"67","keeper":"G7BQM","lat":"52.39","lon":"-1.25","":"","distance":45839.21413020361},{"repeater":"GB3EH","band":"70CM","channel":"RU77","TX":"430.9625","RX":"438.5625","mode":"AV","QTHR":"IO92GC","where":"BANBURY","region":"MIDL","code":"67","keeper":"G4OHB","lat":"52.11","lon":"-1.48","":"","distance":48810.95614136219},{"repeater":"GB3LN","band":"70CM","channel":"RU74","TX":"430.9250","RX":"438.5250","mode":"AV","QTHR":" IO92JO","where":"LEICESTER","region":"MIDL","code":"118.8","keeper":"M0HEL","lat":"52.62","lon":"-1.19","":"","distance":52329.38999924811},{"repeater":"GB3EM","band":"2M","channel":"RV61","TX":"145.7625","RX":"145.1625","mode":"AV","QTHR":"IO92LJ","where":"COLD ASHBY","region":"MIDL","code":"77.0","keeper":"M1FJB","lat":"52.38","lon":"-1.05","":"","distance":59415.04835211756},{"repeater":"GB3EU","band":"70CM","channel":"UR67","TX":"438.4375","RX":"430.8375","mode":"AV","QTHR":"IO92LJ","where":"COLD ASHBY","region":"MIDL","code":"77.0","keeper":"M1FJB","lat":"52.38","lon":"-1.05","":"","distance":59415.04835211756},{"repeater":"GB3RC","band":"70CM","channel":"RU69","TX":"430.8625","RX":"438.4625","mode":"AV","QTHR":"IO81XW","where":"CHELTENHAM","region":"SW","code":"103.5","keeper":"M0URF","lat":"51.92","lon":"-2.01","":"","distance":60197.09675171671},{"repeater":"GB3DC","band":"2M","channel":"RV55","TX":"145.6875","RX":"145.0875","mode":"AV","QTHR":"IO92GW","where":"DERBY","region":"MIDL","code":"71.9","keeper":"G7NPW","lat":"52.94","lon":"-1.44","":"","distance":62451.52289663427},{"repeater":"GB3JM","band":"70CM","channel":"RU70","TX":"430.8750","RX":"438.4750","mode":"AV","QTHR":"IO82OF","where":"LEOMINSTER","region":"WM","code":"118.8","keeper":"M0WYP","lat":"52.22","lon":"-2.76","":"","distance":63126.54214781591},{"repeater":"GB3SM","band":"70CM","channel":"RB13","TX":"433.3250","RX":"434.9250","mode":"AV","QTHR":"IO93BA","where":"STOKE ON TRENT","region":"MIDL","code":"103.5","keeper":"G4SCY","lat":"53.04","lon":"-1.91","":"","distance":64679.938724729065},{"repeater":"GB3ST","band":"70CM","channel":"RB09","TX":"433.2250","RX":"434.8250","mode":"AV","QTHR":"IO83WA","where":"STOKE ON TRENT","region":"MIDL","code":"103.5","keeper":"G8NSS","lat":"53.03","lon":"-2.10","":"","distance":64753.256177694086},{"repeater":"GB3CG","band":"2M","channel":"RV58","TX":"145.7250","RX":"145.1250","mode":"AV","QTHR":"IO81VU","where":"GLOUCESTER","region":"SW","code":"118.8","keeper":"G3LVP","lat":"51.87","lon":"-2.18","":"","distance":67840.41724990455},{"repeater":"GB3GH","band":"70CM","channel":"RB05","TX":"433.1250","RX":"434.7250","mode":"AV","QTHR":"IO81VU","where":"GLOUCESTER","region":"SW","code":"118.8","keeper":"G3LVP","lat":"51.87","lon":"-2.18","":"","distance":67840.41724990455},{"repeater":"GB3TC","band":"70CM","channel":"RB14","TX":"433.3500","RX":"434.9500","mode":"AV","QTHR":"IO92JX","where":"NOTTINGHAM","region":"MIDL","code":"71.9","keeper":"M5ADU","lat":"52.98","lon":"-1.25","":"","distance":73354.47775315586},{"repeater":"GB3NH","band":"70CM","channel":"RU76","TX":"430.9500","RX":"438.5500","mode":"AV","QTHR":"IO92NF","where":"NORTHAMPTON","region":"MIDL","code":"77.0","keeper":"G1IRG","lat":"52.24","lon":"-0.89","":"","distance":73838.86927315853},{"repeater":"GB3FU","band":"2M","channel":"RV60","TX":"145.7500","RX":"145.1500","mode":"AV","QTHR":"IO92JX","where":"NOTTINGHAM","region":"MIDL","code":"71.9","keeper":"M5ADU","lat":"52.99","lon":"-1.22","":"","distance":75472.76928342239},{"repeater":"GB3NF","band":"2M","channel":"RV50","TX":"145.6250","RX":"145.0250","mode":"AV","QTHR":"IO92KX","where":"NOTTINGHAM","region":"MIDL","code":"77.0","keeper":"M0VUB","lat":"52.99","lon":"-1.11","":"","distance":80287.60254812693},{"repeater":"GB3CI","band":"70CM","channel":"RU66","TX":"430.8250","RX":"438.4250","mode":"AV","QTHR":"IO92PM","where":"CORBY","region":"MIDL","code":"77.0","keeper":"G7HPE","lat":"52.51","lon":"-0.68","":"","distance":83937.37421403023},{"repeater":"GB3CO","band":"2M","channel":"RV53","TX":"145.6625","RX":"145.0625","mode":"AV","QTHR":"IO92PM","where":"CORBY","region":"MIDL","code":"77.0","keeper":"G1DIW","lat":"52.51","lon":"-0.68","":"","distance":83937.37421403023},{"repeater":"GB3SG","band":"70CM","channel":"RU73","TX":"430.9125","RX":"438.5125","mode":"AV","QTHR":"IO81VR","where":"STROUD","region":"SW","code":"118.8","keeper":"G1MAW","lat":"51.73","lon":"-2.25","":"","distance":84127.19987801794},{"repeater":"GB3HH","band":"2M","channel":"RV56","TX":"145.7000","RX":"145.1000","mode":"AV","QTHR":"IO93BF","where":"BUXTON","region":"MIDL","code":"71.9","keeper":"G7EKY","lat":"53.23","lon":"-1.91","":"","distance":85806.58641626815},{"repeater":"GB3EE","band":"70CM","channel":"RB12","TX":"433.3000","RX":"434.9000","mode":"AV","QTHR":"IO93JD","where":"MANSFIELD","region":"MIDL","code":"71.9","keeper":"G0RRZ","lat":"53.16","lon":"-1.23","":"","distance":90649.78355113948},{"repeater":"GB3VA","band":"2M","channel":"RV56","TX":"145.7000","RX":"145.1000","mode":"AV","QTHR":"IO91LT","where":"BRILL","region":"SW","code":"118.8","keeper":"G8GQJ","lat":"51.82","lon":"-1.05","":"","distance":92390.87062393436},{"repeater":"GB3SJ","band":"2M","channel":"RV55","TX":"145.6875","RX":"145.0875","mode":"AV","QTHR":"IO83RF","where":"NORTHWICH","region":"NOR","code":"103.5","keeper":"M0WTX","lat":"53.22","lon":"-2.52","":"","distance":93888.57361074409},{"repeater":"GB3RB","band":"70CM","channel":"RB08","TX":"433.2000","RX":"434.8000","mode":"AV","QTHR":"IO93IF","where":"BOLSOVER","region":"MIDL","code":"71.9","keeper":"G1SLE","lat":"53.23","lon":"-1.29","":"","distance":95570.41944508196},{"repeater":"GB3SA","band":"70CM","channel":"RU77","TX":"430.9625","RX":"438.5625","mode":"AV","QTHR":"IO92RP","where":"STAMFORD","region":"MIDL","code":"118.8","keeper":"G8IOA","lat":"52.63","lon":"-0.52","":"","distance":96355.01352244201},{"repeater":"GB3MR","band":"70CM","channel":"RB14","TX":"433.3500","RX":"434.9500","mode":"AV","QTHR":"IO83XH","where":"STOCKPORT","region":"NOR","code":"82.5","keeper":"G8LZO","lat":"53.33","lon":"-2.04","":"","distance":97277.34302932544},{"repeater":"GB3LL","band":"70CM","channel":"RB0","TX":"433.0000","RX":"434.6000","mode":"AV","QTHR":"IO82KW","where":"LLANGOLLEN","region":"WM","code":"94.8","keeper":"GW0NIS","lat":"52.95","lon":"-3.15","":"","distance":99466.95691117087},{"repeater":"GB3CW","band":"70CM","channel":"RB04","TX":"433.1000","RX":"434.7000","mode":"AV","QTHR":"IO82HL","where":"NEWTOWN POWYS","region":"WM","code":"103.5","keeper":"GW4IQP","lat":"52.48","lon":"-3.40","":"","distance":100506.10290379194},{"repeater":"GB3PW","band":"2M","channel":"RV62","TX":"145.7750","RX":"145.1750","mode":"AV","QTHR":"IO82HL","where":"NEWTOWN POWYS","region":"WM","code":"103.5","keeper":"GW4IQP","lat":"52.48","lon":"-3.40","":"","distance":100506.10290379194},{"repeater":"GB3GR","band":"70CM","channel":"RU68","TX":"430.8500","RX":"438.4500","mode":"AV","QTHR":"IO92QV","where":"GRANTHAM","region":"MIDL","code":"71.9","keeper":"G0OJF","lat":"52.91","lon":"-0.58","":"","distance":103150.68036880835},{"repeater":"GB3BL","band":"70CM","channel":"RU70","TX":"430.8750","RX":"438.4750","mode":"AV","QTHR":"IO92SD","where":"BEDFORD","region":"MIDL","code":"77.0","keeper":"G8MGP","lat":"52.15","lon":"-0.48","":"","distance":103522.19231539933},{"repeater":"GB3AV","band":"70CM","channel":"RB02","TX":"433.0500","RX":"434.6500","mode":"AV","QTHR":"IO91OT","where":"AYLESBURY","region":"SW","code":"118.8","keeper":"G8GQJ","lat":"51.81","lon":"-0.81","":"","distance":104412.57669888575},{"repeater":"GB3WH","band":"2M","channel":"RV52","TX":"145.6500","RX":"145.0500","mode":"AV","QTHR":"IO91EM","where":"SWINDON","region":"SW","code":"118.8","keeper":"G4LDL","lat":"51.53","lon":"-1.66","":"","distance":104710.92750100845},{"repeater":"GB3CR","band":"70CM","channel":"RB06","TX":"433.1500","RX":"434.7500","mode":"AV","QTHR":"IO83LC","where":"CAERGWRLE","region":"WM","code":"110.9","keeper":"M0OBW","lat":"53.11","lon":"-3.05","":"","distance":105165.13517095693},{"repeater":"GB3AA","band":"2M","channel":"RV53","TX":"145.6625","RX":"145.0625","mode":"AV","QTHR":"IO81RO","where":"BRISTOL","region":"SW","code":"94.8","keeper":"G4CJZ","lat":"51.59","lon":"-2.54","":"","distance":105553.19880340532},{"repeater":"GB3US","band":"70CM","channel":"RB0","TX":"433.0000","RX":"434.6000","mode":"AV","QTHR":"IO93GI","where":"SHEFFIELD","region":"NOR","code":"103.5","keeper":"M0RFT","lat":"53.37","lon":"-1.46","":"","distance":105895.71059115737},{"repeater":"GB3PE","band":"2M","channel":"RV54","TX":"145.6750","RX":"145.0750","mode":"AV","QTHR":"IO92TL","where":"PETERBOROUGH","region":"SE","code":"94.8","keeper":"M0ZPU","lat":"52.50","lon":"-0.35","":"","distance":106198.78438664766},{"repeater":"GB3BF","band":"2M","channel":"RV63","TX":"145.7875","RX":"145.1875","mode":"AV","QTHR":"IO92SC","where":"BEDFORD","region":"MIDL","code":"77.0","keeper":"G8MGP","lat":"52.11","lon":"-0.46","":"","distance":106385.76040076667},{"repeater":"GB3DI","band":"70CM","channel":"RB06","TX":"433.1500","RX":"434.7500","mode":"AV","QTHR":"IO91IN","where":"DIDCOT","region":"SW","code":"118.8","keeper":"G8CUL","lat":"51.57","lon":"-1.31","":"","distance":107147.93526520577},{"repeater":"GB3DS","band":"70CM","channel":"RB13","TX":"433.3250","RX":"434.9250","mode":"AV","QTHR":"IO93KH","where":"WORKSOP","region":"MIDL","code":"71.9","keeper":"G3XXN","lat":"53.30","lon":"-1.13","":"","distance":107449.3122994717},{"repeater":"GB3TD","band":"70CM","channel":"RB03","TX":"433.0750","RX":"434.6750","mode":"AV","QTHR":"IO91DL","where":"SWINDON","region":"SW","code":"118.8","keeper":"G4XUT","lat":"51.49","lon":"-1.70","":"","distance":108691.61854566132},{"repeater":"GB3AB","band":"70CM","channel":"RB07","TX":"433.1750","RX":"434.7750","mode":"AV","QTHR":"IO93FK","where":"SHEFFIELD","region":"NOR","code":"82.5","keeper":"M0GAV","lat":"53.42","lon":"-1.54","":"","distance":109870.7957133422}]

repeaters.forEach(addStation)

</script>
</body>
</html>
